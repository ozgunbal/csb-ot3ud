(this.webpackJsonpreact=this.webpackJsonpreact||[]).push([[0],{178:function(e,t,n){},179:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(13),c=n.n(a),s=n(10),o=n.n(s),i=n(17),l=n(20),u=n(15),d=n(211),j=n(215),p=n(30),b=(n(92),"https://guarded-ridge-89710.herokuapp.com"),h="",m=function(){var e=Object(i.a)(o.a.mark((function e(t){var n,r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.username,r=t.password,e.next=3,fetch("".concat(b,"/api/tokens"),{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,password:r})});case 3:return a=e.sent,e.abrupt("return",a.json());case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(b,"/api/marketplaces/").concat(t,"/holdings"),{method:"GET",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(h)}});case 2:return n=e.sent,e.abrupt("return",n.json());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=Object(i.a)(o.a.mark((function e(t){var n,r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(b,"/api/sessions?marketplaceId=").concat(t),{method:"GET",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(h)}});case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,a=r._embedded.sessions,e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=n(6);var v=function(){var e=Object(u.f)(),t=Object(r.useState)(""),n=Object(l.a)(t,2),a=n[0],c=n[1],s=Object(p.b)({defaultValues:{password:"",email:"",account:""}}),b=s.handleSubmit,f=s.control,O=s.errors,v=function(){var t=Object(i.a)(o.a.mark((function t(n){var r,a,s,i;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.account,a=n.email,s=n.password,t.prev=1,t.next=4,m({username:"".concat(r,"|").concat(a),password:s});case 4:i=t.sent,o=i.token,h=o,console.log(h),e.push("/dashboard",{personId:i.person.id,person:i.person}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),c(t.t0.message);case 12:case"end":return t.stop()}var o}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}();return console.log(O),Object(x.jsx)("div",{className:"App",children:Object(x.jsxs)("header",{className:"App-header",children:[Object(x.jsx)("h2",{children:"Flex E-Market Experiment"}),Object(x.jsxs)("form",{onSubmit:b(v),style:{display:"flex",flexDirection:"column"},children:[Object(x.jsx)(p.a,{name:"account",control:f,rules:{required:"Required field"},render:function(e){var t=e.onChange,n=e.value;return Object(x.jsx)(d.a,{style:{margin:"10px 0"},label:"Account",variant:"outlined",value:n,onChange:t,error:!!O.account,helperText:O.account&&O.account.message})}}),Object(x.jsx)(p.a,{name:"email",control:f,rules:{required:"Required field"},render:function(e){var t=e.onChange,n=e.value;return Object(x.jsx)(d.a,{style:{margin:"10px 0"},label:"E-mail",variant:"outlined",value:n,onChange:t,error:!!O.email,helperText:O.email&&O.email.message})}}),Object(x.jsx)(p.a,{name:"password",control:f,rules:{required:"Required field"},render:function(e){var t=e.onChange,n=e.value;return Object(x.jsx)(d.a,{style:{margin:"10px 0"},label:"Password",variant:"outlined",type:"password",value:n,onChange:t,error:!!O.password,helperText:O.password&&O.password.message})}}),a?Object(x.jsx)("div",{style:{color:"red"},children:"Login failed."}):null,Object(x.jsx)(j.a,{variant:"contained",color:"primary",type:"submit",children:"SIGN IN"})]})]})})},g=n(103),y=n(19),w=n(219),k=n(187),S=n(224),D=n(184),C=n(182),E=n(185),T=n(216),I=n(217),N=function(e){var t,n=e.data,r=e.cashDifference,a=e.valuations,c=n.grant.canBuy?"BUYER":"SELLER",s=Math.abs(n.units-n.grant.units),o=s>0&&a?a.slice(0,s).reduce((function(e,t){return e+t})):0;return t="BUYER"===c?o-r/100:r/100-o,a?Object(x.jsxs)("p",{children:["Profit: ",t.toFixed(2)]}):Object(x.jsx)("p",{children:"Couldn't find valuations"})},M=function(e){var t=e.data,n=e.cashDifference,a=e.valuations,c=Object(r.useState)(!1),s=Object(l.a)(c,2),o=s[0],i=s[1];return Object(x.jsxs)(T.a,{style:{padding:10,cursor:"pointer",minWidth:300},onClick:function(){return i((function(e){return!e}))},children:["Cash",o?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)(I.a,{color:"textSecondary",children:["Owner : ",t.owner.firstName," ",t.owner.lastName,Object(x.jsx)("br",{}),"Session is ",t.session.state,Object(x.jsx)("br",{}),"MarketPlace: ",t.marketplace.name,Object(x.jsx)("br",{}),Object(x.jsx)("br",{})]}),Object(x.jsx)("p",{children:t.assets.map((function(e){return Object(x.jsx)(N,{data:e,cashDifference:n,valuations:a})}))})]}):null]})},q=n(218),B=function(e){var t=e.sessions;return t?Object(x.jsx)(T.a,{style:{margin:10},children:Object(x.jsxs)(q.a,{children:[Object(x.jsxs)(I.a,{ccolor:"textSecondary",gutterBottom:!0,children:["Session Count: ",t.length]}),Object(x.jsxs)(I.a,{color:"textSecondary",children:[t.filter((function(e){return"CLOSED"===e.state})).length," session(s) CLOSED"]}),Object(x.jsxs)(I.a,{variant:"h5",children:[t.filter((function(e){return"OPEN"===e.state})).length," session OPEN"]})]})}):null},R=n(69),A=new Date((new Date).setHours(0,0,0));var P=function(){var e=Object(u.f)(),t=Object(u.g)().state,n=Object(r.useState)(),a=Object(l.a)(n,2),c=a[0],s=a[1],d=Object(r.useState)(),b=Object(l.a)(d,2),h=b[0],m=b[1],v=Object(r.useState)(),T=Object(l.a)(v,2),I=T[0],N=T[1],q=Object(r.useState)(),P=Object(l.a)(q,2),L=P[0],J=P[1],F=Object(r.useState)(),G=Object(l.a)(F,2),z=G[0],H=G[1],U=Object(p.b)({defaultValues:{startDate:A,marketplaceId:""}}),V=U.handleSubmit,Y=U.control,K=U.errors,W=function(){var e=Object(i.a)(o.a.mark((function e(n){var r,a,c,i,l,u,d,j;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.marketplaceId,a=n.startDate,H(!1),e.next=4,O(r);case 4:return c=e.sent,i=c.filter((function(e){return new Date(e.createdDate).getTime()>a.getTime()})).sort((function(e,t){return new Date(e.createdDate).getTime()>new Date(t.createdDate).getTime()})),l=i.map((function(e){return e.id})),e.next=9,f(r);case 9:u=e.sent,d=u.filter((function(e){return e.owner.id===t.personId})).filter((function(e){return l.includes(e.session.id)})),s(d),m(i),J(i.length-1),N(R[r][t.person.email][i.length-1]||[]),j=i.every((function(e){return"CLOSED"===e.state})),H(i.length>4&&j);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){t||e.push("/")}),[t,e]);var _=Object.keys(R).filter((function(e){return Object.keys(R[e]).includes(t.person.email)}));return Object(x.jsx)("div",{className:"App",children:Object(x.jsxs)("header",{className:"App-header",children:[Object(x.jsxs)("form",{onSubmit:V(W),style:{display:"flex",flexDirection:"column"},children:[Object(x.jsx)(p.a,{name:"marketplaceId",control:Y,rules:{required:"Required field"},render:function(e){var t=e.onChange,n=e.value;return Object(x.jsxs)(C.a,{error:K.marketplaceId,children:[Object(x.jsx)(k.a,{id:"demo-simple-select-filled-label",children:"Marketplace ID"}),Object(x.jsx)(E.a,{labelId:"demo-simple-select-filled-label",id:"demo-simple-select-filled",value:n,onChange:t,children:_.map((function(e){return Object(x.jsx)(S.a,{value:e,children:e})}))}),K.marketplaceId?Object(x.jsx)(D.a,{children:K.marketplaceId.message}):null]})}}),Object(x.jsx)(y.a,{utils:g.a,children:Object(x.jsx)(p.a,{name:"startDate",control:Y,render:function(e){var t=e.onChange,n=e.value;return Object(x.jsx)(w.a,{disableToolbar:!0,variant:"inline",format:"MM/dd/yyyy",margin:"normal",id:"date-picker-inline",label:"Experiment Date",value:n,onChange:t,KeyboardButtonProps:{"aria-label":"change date"}})}})}),Object(x.jsx)(j.a,{variant:"contained",color:"primary",type:"submit",children:c?"ReSend":"Send"})]}),Object(x.jsx)(B,{sessions:h}),c?c.length?Object(x.jsxs)("div",{style:{padding:5},children:[Object(x.jsx)("p",{children:"Holdings:"}),Object(x.jsx)("ul",{children:c.map((function(e){var t=Math.abs(e.cash-e.capital.cash);return Object(x.jsx)(M,{data:e,cashDifference:t,valuations:L>=0?I:void 0},e.owner.createdDate)}))})]}):Object(x.jsx)("div",{children:"There's no holding"}):null,z>4?Object(x.jsx)("div",{children:"Move to next market "}):null]})})},L=n(56),J=(n(178),document.getElementById("root"));c.a.render(Object(x.jsx)(r.StrictMode,{children:Object(x.jsx)(L.a,{children:Object(x.jsxs)(u.c,{children:[Object(x.jsx)(u.a,{exact:!0,path:"/",component:v}),Object(x.jsx)(u.a,{exact:!0,path:"/dashboard",component:P})]})})}),J)},69:function(e){e.exports=JSON.parse('{"1209":{"subject1@fm.com":[[2,1.5,1],[4,3,2],[6,4.5,3],[8,6,4],[10,7.5,5]],"robot1@robot.com":[[2,1.5,1],[4,3,2],[6,4.5,3],[8,6,4],[10,7.5,5]]},"1210":{"subject1@fm.com":[[2,1.5,1],[4,3,2],[6,4.5,3],[8,6,4],[10,7.5,5]],"robot1@robot.com":[[2,1.5,1],[4,3,2],[6,4.5,3],[8,6,4],[10,7.5,5]]},"1213":{"subject1@fm.com":[[2,1.5,1],[4,3,2],[6,4.5,3],[8,6,4],[10,7.5,5]]}}')},92:function(e,t,n){}},[[179,1,2]]]);
//# sourceMappingURL=main.ceee705a.chunk.js.map